name: Pre-commit Checks

on:
    push:
        branches: ["main"]
    pull_request:
        branches: ["main"]

permissions:
    contents: read

jobs:
    run-pre-commit:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4.3.1

            - name: Setup Python
              uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065 # v5.6.0
              with:
                  python-version: "3.12"

            - name: Install pre-commit
              run: |
                  python -m pip install --upgrade pip
                  python -m pip install pre-commit

            - name: Run pre-commit hooks
              run: pre-commit run -a --show-diff-on-failure

            - name: Job Summary
              shell: bash
              run: |
                  set -euo pipefail
                  echo "## Pre-commit checks" >> "$GITHUB_STEP_SUMMARY"
                  echo "Ran hooks on all files. See job logs for details." >> "$GITHUB_STEP_SUMMARY"
